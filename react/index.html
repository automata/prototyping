<!DOCTYPE html>
<html>
<head>
  <title>react + svg test</title>

  <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no" />

  <style>
    body {
      padding: 0;
      margin: 0;
      background-color: hsl(0, 0%, 0%);
      font-family: monospace;
      overflow: hidden;
      color: white;
    }
    a {
      color: white;
    }
  </style>
  <link rel="stylesheet" href="the-graph-svg.css">

  <script src="//cdnjs.cloudflare.com/ajax/libs/dat-gui/0.5/dat.gui.min.js"></script>
  <script src="//cdnjs.cloudflare.com/ajax/libs/jquery/2.0.3/jquery.min.js"></script>
  <script src="../kieler-interface.js"></script>

  <script src="//cdnjs.cloudflare.com/ajax/libs/react/0.8.0/react.js"></script>

  <script src="the-graph.js"></script>
  <script src="the-graph-app.js"></script>
  <script src="the-graph-graph.js"></script>
  <script src="the-graph-edge.js"></script>
  <script src="font-awesome-unicode-map.js"></script>
  <script src="the-graph-node.js"></script>
  <script src="the-graph-group.js"></script>
  <script src="the-graph-port.js"></script>
  <script src="the-graph-tooltip.js"></script>

</head>
<body>
  <div id="app"></div>
  <div style="position:absolute; top:0; left:0;">
    <a href="https://github.com/forresto/prototyping/blob/gh-pages/react/">source</a> ~ 
    wheel to zoom ~ 
    <!-- <input id="zoom" type="range" min="0.04" max="8" step="0.01" value="1.0"></input><br/> -->
    drag to pan
  </div>

  <script type="text/javascript">
  (function(){
    "use strict";

    window.loadGraph = function (graph) {
      window.graph = graph;

      var width = window.innerWidth;
      var height = window.innerHeight;

      var app = React.renderComponent(
        TheGraph.App({
          graph: graph,
          width: width,
          height: height
        }),
        document.getElementById('app')
      );

      window.addEventListener('resize', function(){
        width = window.innerWidth;
        height = window.innerHeight;
        app.setState({
          width: width,
          height: height
        });
      });

      // var zoom = document.getElementById("zoom")
      // zoom.onmousemove = function (event) {
      //   // Don't drag
      //   event.stopPropagation();
      // };
      // zoom.addEventListener("input", function(event){
      //   app.setState({
      //     scale: parseFloat(event.target.value)
      //   });
      // });
      
    };

    window.onload = function () {
      var script = document.createElement('script');
      script.src = 'photobooth.json.js';
      document.head.appendChild(script);

      var KielerOptions = function () {
        // standard Kieler options
        this.aligment = 'AUTOMATIC';
        this.aspectRatio = 1.6;
        this.borderSpacing = 12;
        this.debugMode = false;
        this.direction = 'RIGHT';
        this.edgeRouting = 'POLYLINE';
        this.layoutHierarchy = true;
        // this.nodeLabelPlacement = ???
        this.portConstraints = 'UNDEFINED';
        this.portLabelPlacement = 'OUTSIDE';
        this.priority = 1;
        this.randomSeed = 1;
        this.separateConnComp = true;
        // this.sizeConstraint = ???
        this.sizeOptions = 'DEFAULT_MINIMUM_SIZE';
        this.spacing = 20.0;
        
        // klay layered options
        this.crossMin = 'LAYER_SWEEP';        
        this.cycleBreaking = 'GREEDY';
        this.edgeSpacingFactor = 0.5;
        this.feedBackEdges = false;
        this.fixedAlignment = 'NONE';
        this.inLayerSpacingFactor = 1;
        this.interactiveReferencePoint = 'CENTER';
        this.LabelSide = 'SMART';
        this.layerConstraint = 'NONE';
        this.mergePorts = false;
        this.nodeLayering = 'NETWORK_SIMPLEX';
        this.nodePlace = 'BRANDES_KOEPF';
        this.thoroughness = 7;

        this.apply = function () {
          var event = new CustomEvent("kieler", { detail: this });
          window.dispatchEvent(event);
        };
      };

      var kielerOptions = new KielerOptions();

      var gui = new dat.GUI();
      var f1 = gui.addFolder('Standard Layout Options');
      f1.add(kielerOptions, 'aligment', ['AUTOMATIC']);
      f1.add(kielerOptions, 'aspectRatio', 0.5, 10.0);
      f1.add(kielerOptions, 'borderSpacing', 0, 100.0);
      f1.add(kielerOptions, 'debugMode', false);
      f1.add(kielerOptions, 'direction', ['RIGHT', 'DOWN']);
      f1.add(kielerOptions, 'edgeRouting', ['POLYLINE']);
      f1.add(kielerOptions, 'layoutHierarchy', true);
      // f1.add(kielerOptions, 'nodeLabelPlacement', ???);
      f1.add(kielerOptions, 'portConstraints', ['UNDEFINED']);
      f1.add(kielerOptions, 'portLabelPlacement', ['OUTSIDE']);
      f1.add(kielerOptions, 'priority', 1, 10);
      f1.add(kielerOptions, 'randomSeed', 1, 100);
      f1.add(kielerOptions, 'separateConnComp', true);
      // f1.add(kielerOptions, 'sizeConstraint', ???);
      f1.add(kielerOptions, 'sizeOptions', ['DEFAULT_MINIMUM_SIZE']);
      f1.add(kielerOptions, 'spacing', 5, 100);

      var f2 = gui.addFolder('KLay Layered Options');
      f2.add(kielerOptions, 'crossMin', ['LAYER_SWEEP', 'INTERACTIVE']);
      f2.add(kielerOptions, 'cycleBreaking', ['GREEDY', 'INTERACTIVE']);
      f2.add(kielerOptions, 'edgeSpacingFactor', 0.5, 10);
      f2.add(kielerOptions, 'feedBackEdges', false);
      f2.add(kielerOptions, 'inLayerSpacingFactor', 0, 50);
      f2.add(kielerOptions, 'interactiveReferencePoint', ['CENTER', 'TOP_LEFT']);
      f2.add(kielerOptions, 'LabelSide', ['SMART', 'ALWAYS_UP', 'ALWAYS_DOWN', 'DIRECTION_UP', 'DIRECTION_DOWN']);
      f2.add(kielerOptions, 'layerConstraint', ['NONE', 'FIRST', 'FIRST_SEPARATE', 'LAST', 'LAST_SEPARATE']);
      f2.add(kielerOptions, 'mergePorts', false);
      f2.add(kielerOptions, 'nodeLayering', ['NETWORK_SIMPLEX', 'LONGEST_PATH', 'INTERACTIVE']);
      f2.add(kielerOptions, 'nodePlace', ['BRANDES_KOEPF', 'SIMPLE', 'LINEAR_SEGMENTS']);
      f2.add(kielerOptions, 'thoroughness', 1, 20);

      gui.add(kielerOptions, 'apply');
    }

  })();
  </script>

</body>
</html>
